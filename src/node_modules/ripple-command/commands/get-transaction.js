'use strict';

var _ = require('lodash');
var program = require('commander');
var {Config} = require('ripple-command/config');
var {Console} = require('ripple-command/console');
var {RippleWrapper} = require('ripple-command/api/ripple-wrapper');

program
    .command('get-transaction <id>')
    .option('--max-ledger-version <max>', 'The highest ledger version to search')
    .option('--min-ledger-version <min>', 'The lowest ledger version to search.')
    .description('Retrieves a transaction by its Transaction ID.')
    .action(function(id, command) {
        let opts = command.opts();
        Config.absorb(program.opts(), opts);

        var options = {};
        if (opts['maxLedgerVersion'] !== undefined) {
            options['maxLedgerVersion'] = parseInt(opts['maxLedgerVersion'], 10);
        }
        if (opts['minLedgerVersion'] !== undefined) {
            options['minLedgerVersion'] = parseInt(opts['minLedgerVersion'], 10);
        }

        (new RippleWrapper()).invoke('getTransaction', id, options).then((tx) => {
            Console.out('Transaction:');
            Console.out(tx, 1);
        }).catch(_.noop);
    })
    ;
